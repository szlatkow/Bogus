# Bogus CI/CD documentation

## 1. Set up TestSpace

The TestSpace tool is used to display the results.xml, that is generated by the internal testing sequence of the Bogus project.

### Initial set up
##### - connect your GitHub projects to TestSpace 

1. Go to https://www.testspace.com/

2. Click on the "Start for free" button

3. Click on the "Get started" button, under the "Free plan" box

4. Go to the bottom of the page and click on "Install it for free" button

5. Click on the "Complete order and begin installation" button

6. Select which repositories to work with this TestSpace installation
* select "Only select repositories" for better overall control
* from the dropdown, select the repositories you would like to see on the TestSpace dashboard

7. Enter your password, if prompt

8. You are going to be re-directed to the TestSpace dashboard

9. At the top right corner, click on your account name and choose **Edit** from the dropdown menu

10. Copy the value from the input field under the **Access Token** label

11. Go to GitHub and enter your repo

12. In the **Settings** tab, go to **Secrets**, add a new secret with the name **TESTSPACE_TOKEN** and paste the value you copied in step 10

- the TestSpace token is optional for public repos, but we've made it part of the implementation, to give the owner of the repo additional security

13. Go back to your TestSpace dashboard

14. On the righthand side at the top, click on "+ New Project" button

15. Select the GitHub repo you would like to display and click "OK"

16. Click on the name of your project

17. As soon as a workflow is ran successfully for the connected GitHub project, you would be able to see the results listed here
* "space" refers to a GitHub repo branch (master, feature/new-feature etc.) and each branch is displayed as a separate entity

<br>

### Set up a badge
##### - create a badge in your README.md to quickly reference your internal test results (this would be available once the CI portion of your workflow is successfully run in your master branch)

1. Go to https://www.testspace.com/

2. Click "Sign in" at the right corner

3. In the "Project Listing", find your project and click on the "master" space

4. Click on the badge, that is above the data table

5. Click "Embed link"

6. From the dropdown select "Markdown"

7. Copy the contents below

8. Go to the GitHub repo of the project

9. Open the README.md

10. Paste the Markdown code at your preferred place
* if such badge already exists, replace it with your new one, so that it references the correct TestSpace space

<br>

  ## 2. SonarCloud 

1. Go to https://sonarcloud.io/

2. Click the "Log in" button and create a new account or connect with GitHub account (recomended).

3. At the top right corner click the "+" sign.

4. From the dropdown select "Analyze new project".

5. Select the "Bogus" project and click "Set Up" button at the top right corner.

6. Under the "Choose another analysis method" sign click the "With Github Actions" sign. 

7. Follow the instructions at the first step and create a Secret.
 You don't need to set up the workflow because it is already set by us.

8. To get your status Badge, click the "Get project Badges" button at the bottom right.

9. Run your workflow!

## 3. Create a release

The "Release sequence" encompasses creating a release in your GitHub repo, adding the necessary files to it and pushing a NuGet package to the NuGet website.

Files added are: 
- NuGet package
- Symbols NuGet package
- Compilation folder (zip)
- Internal test results (xml)
- Source code (zip)
- Source code (tar.gz)

Note: **not every commit to your master branch creates a release**

Follow these instructions for any commit (push or PR merge) to your master branch, you would like to create a release.

Whenever you would like to trigger the "Create release" sequence, you would need one of three keywords at the start of your commit title. Each of the three keywords corresponds to a number in your release version i.e. v1.2.3. The release versioning uses the ["Conventional Commits" specification](https://www.conventionalcommits.org/en/v1.0.0/):

* "fix: ..." - this keyword corresponds to the last number v1.2.**3**, also known as PATCH;
* "feat: ..." - this keyword corresponds to the middle number v1.**2**.3, also known as MINOR;
* "perf: ..." - this keyword corresponds to the first number v**1**.2.3, also known as MAJOR. In addition, to trigger a MAJOR release, you would need to write "BREAKING CHANGE: ..." in the description of the commit, with an empty line above it to indicate it is in the <footer> portion of the description;

Note: when making a MAJOR release by committing through a terminal, use the multiple line syntax to add the commit title on one line and then adding an empty line, and then adding the "BREAKING CHANGE: " label
<br><br>
### EXAMPLES

Example(fix/PATCH): <br>
`
git commit -a -m "fix: this is a PATCH release triggering commit"
`
<br>
`
git push origin master
`
<br>
Result: v1.2.3 -> **v1.2.4**
<br>
<br>
<br>
Example(feat/MINOR): <br>
`
git commit -a -m "feat: this is a MINOR release triggering commit"
`
<br>
`
git push origin master
`
<br>
Result: v1.2.3 -> **v1.3.0**
<br>
<br>
<br>
Example(perf/MAJOR): <br>
``
git commit -a -m "perf: this is a MAJOR release triggering commit `
``
<br> 
&gt;&gt; <br> 
&gt;&gt; ` BREAKING CHANGE: this is the breaking change"
`
<br>
`
git push origin master
`
<br>
Result: v1.2.3 -> **v2.0.0**
<br>
<br>
Note: in the MAJOR release example, the PowerShell multiline syntax ` (backtick) is used. After writing a backtick, a press of the Enter key should open a new line.


## 4. Publish to NuGet

1. Go to https://www.nuget.org/ .

2. Log in or create your account.

3. From the dropdown in the right top corner (with your account name on it) choose **API Keys**.

4. Create a new token by clicking the "+ Create" button.

5. Set the **Key name** to "NUGET TOKEN" so it's compatible with your workflow.

6. On **Package Owner** choose your username from the dropdown.

7. To select which packages to associate with a key, use a glob pattern, select individual packages, or both.

8. Set your package name in the **Glob Pattern** field.

9. Now you have to set the token as a **secret** in Github in order to make it work.

## Creating encrypted secrets for a repository

1. On GitHub, navigate to the main page of the repository.

2. Under your repository name, click  Settings.

3. Repository settings button.

4. In the left sidebar, click Secrets.

5. Click New repository secret.

6. Type the name "NUGET_TOKEN" as a name of your secret.

7. Enter the value for your secret.

8. Click Add secret.
   **You are all set up**

## 5. Set up Dependabot

Dependabot is a GitHub native security tool that goes through the dependencies in your project and creates alerts, and PRs with updates when a new and/or non-vulnerable version is found.

- for PRs with version updates, this pipeline comes pre-configured for all current dependency sources in your project, so at "Insights" tab -> "Dependency graph" -> "Dependabot", you should be able to see all tracked sources of dependencies, when they have been checked last and view a full log of the last check

![Dependabot_tab](/Docs/CI-CD_DOCUMENTATION/Dependabot_tab.png)

![Dependabot_log_page](/Docs/CI-CD_DOCUMENTATION/Dependabot_log_page.png)

### Set up security alerts and updates
##### - GitHub, through Dependabot, also natively offers a security check for vulnerable dependencies

1. Go to "Settings" tab of your repo

2. Go to "Security&Analysis" section

3. Click "Enable" for both "Dependabot alerts" and "Dependabot security updates"

- By enabling "Dependabot alerts", you would be notified for any vulnerable dependencies in your project. At "Security" tab -> "Dependabot alerts", you can manage all alerts. By clicking on an alert, you would be able to see a detailed explanation of the vulnerability and a viable solution.

![Dependabot_alerts_page](/Docs/CI-CD_DOCUMENTATION/Dependabot_alerts_page.png)

![Dependabot_alert_page](/Docs/CI-CD_DOCUMENTATION/Dependabot_alert_page.png)

- By enabling "Dependabot security updates", you authorize Dependabot to create PRs specifically for **security updates**

![Dependabot_PRs](/Docs/CI-CD_DOCUMENTATION/Dependabot_PRs.png)
